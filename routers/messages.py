from datetime import datetime

from database import tables
from settings import settings


def get_help_message() -> str:
    """Help message"""
    message = "<b>–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –±–æ—Ç–∞:</b>\n" \
              "- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –æ–ø–ª–∞—Ç—É –∑–∞ –ø–æ–¥–ø–∏—Å–∫—É\n" \
              "- –û—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤/–≥—Ä—É–ø–ø\n\n" \
              "<b>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:</b>\n" \
              "- –î–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É /start –∏ —Å–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º\n" \
              "- –î–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É /menu\n" \
              "- –î–ª—è –ø–æ–∫—É–ø–∫–∏ –∏–ª–∏ –ø—Ä–æ–¥–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏ –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é –Ω–∞–∂–º–∏—Ç–µ \"–ö—É–ø–∏—Ç—å üí∏\"\n" \
              "- –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–≤–æ–µ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–ø–∏—Å–∫–∏ –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é –Ω–∞–∂–º–∏—Ç–µ \"–°—Ç–∞—Ç—É—Å üé´\"\n\n" \
              "<b>–ö–æ–Ω—Ç–∞–∫—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏:</b>\n" \
              "–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞—à–µ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –≤ —Ç–µ–ª–µ–≥—Ä–∞–º: @aleksandr_andreew"
    return message


def subscription_info(user: tables.User) -> str:
    if not user.subscription:
        return "–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ø–æ–¥–ø–∏—Å–∫–∏, –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–∏–æ–±—Ä–µ—Å—Ç–∏ –µ–µ –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é –ø–æ –∫–Ω–æ–ø–∫–µ \"–ö—É–ø–∏—Ç—å üí∏\""

    message = ""
    expire_date = datetime.strftime(user.subscription[0].expire_date, '%d.%m.%Y')

    if user.subscription[0].is_active:
        message += f"üü¢ –í–∞—à–∞ –ø–æ–¥–ø–∏—Å–∫–∞ <b>–ê–∫—Ç–∏–≤–Ω–∞</b> –¥–æ <b>{expire_date}</b>"
    else:
        message += f"üî¥ –°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –≤–∞—à–µ–π –ø–æ–¥–ø–∏—Å–∫–∏ –∏—Å—Ç–µ–∫ <b>{expire_date}</b>\n" \
                   f"–í—ã –º–æ–∂–µ—Ç–µ –ø—Ä–∏–æ–±—Ä–µ—Å—Ç–∏ –ø–æ–¥–ø–∏—Å–∫—É –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é /start"

    return message


def get_invoice_message(period: str) -> str:
    message = "–î–ª—è –æ–ø–ª–∞—Ç—ã –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ "

    if period == "1":
        message += "<b>1 –º–µ—Å—è—Ü</b> "
        amount = "<b>100 —Ä.</b>"

    elif period == "3":
        message += "<b>3 –º–µ—Å—è—Ü–∞</b> "
        amount = "<b>300 —Ä.</b>"

    else:
        message += "<b>–Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥</b> "
        amount = "<b>1000 —Ä.</b>"

    message += f"–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥ –ø–æ —Å—Å—ã–ª–∫–µ \n{settings.payment_link}\n–Ω–∞ —Å—É–º–º—É {amount}\n\n" \
               f"–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–ª–∞—Ç—ã –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É <b>\"–û–ø–ª–∞—Ç–∏–ª\"</b>"

    return message


def message_for_admin(user: tables.User, period: str) -> str:
    """–û–ø–æ–≤–µ—â–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∞ –æ–± –æ–∂–∏–¥–∞–Ω–∏–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞"""
    message = f"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å id: {user.tg_id} "
    if user.username:
        message += f"@{user.username} "
    if user.firstname:
        message += f"{user.firstname} "
    if user.lastname:
        message += f"{user.lastname} "

    if period == "1":
        text = "<b>1 –º–µ—Å—è—Ü</b> "
        amount = "<b>100 —Ä.</b>"

    elif period == "3":
        text = "<b>3 –º–µ—Å—è—Ü–∞</b> "
        amount = "<b>300 —Ä.</b>"

    else:
        text = "<b>–Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥</b> "
        amount = "<b>1000 —Ä.</b>"

    message += f"–æ–ø–ª–∞—Ç–∏–ª –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ {text} —Å—Ç–æ–∏–º–æ—Å—Ç—å—é {amount} \n\n–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–ª–∏ –æ—Ç–∫–ª–æ–Ω–∏—Ç–µ –æ–ø–ª–∞—Ç—É"


def get_waiting_message() -> str:
    message = "–î–æ–∂–¥–∏—Ç–µ—Å—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ–ø–ª–∞—Ç—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º, –ø–æ—Å–ª–µ –≤–∞–º –±—É–¥–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ –¥–ª—è –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤ –∫–∞–Ω–∞–ª"
    return message
